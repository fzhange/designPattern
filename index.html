<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      let objFlatObj = {
        a: {
          b: {
            c: {
              d: 1,
            },
          },
        },
        aa: 2,
        c: [1, 2],
      };

      function objFlat(objFlatObj) {
        let res = {};
        Object.entries(objFlatObj).forEach(([key, val]) => {
          if (typeof val === 'object') {
            if (Array.isArray(val) || val == null) {
              res[key] = val;
            } else {
              let restObj = objFlat(val);
              Object.entries(restObj).forEach(([k, v]) => {
                res[`${key}.${k}`] = v;
              });
            }
          } else {
            res[key] = val;
          }
        });
        return res;
      }

      function openObj(objFlatObj) {
        let res = {};
        Object.entries(objFlatObj).forEach(([key, val]) => {
          if (key.includes('.')) {
            let keyList = key.split('.');
            let resetObj = {};
            resetObj[keyList.slice(1).join('.')] = val;
            res[key] = openObj(resetObj);
          } else {
            res[key] = val;
          }
        });
        return res;
      }

      console.log('objFlat(objFlatObj);: ', JSON.stringify(objFlat(objFlatObj))); //{"a.b.c.d":1,"aa":2,"c":[1,2]}

      console.log(
        'openObj({"a.b.c.d":1,"aa":2,"c":[1,2]}): ',
        openObj({ 'a.b.c.d': 1, aa: 2, c: [1, 2] }),
      );
    </script>
  </body>
</html>
